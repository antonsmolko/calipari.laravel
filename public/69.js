(window.webpackJsonp=window.webpackJsonp||[]).push([[69],{112:function(e,t,r){"use strict";var n={name:"ImageTableActions",props:{item:{type:Object,default:null},remove:{type:Boolean,default:!1}},computed:{hasCollection:function(){return Boolean(this.item.colorCollection)},isCollectionMainImage:function(){return this.hasCollection&&this.item.id===this.item.colorCollection.main_image_id}},methods:{onDelete:function(){this.$emit("delete",this.item)},onRemove:function(){this.$emit("remove",this.item.id)}}},o=r(0),i=Object(o.a)(n,(function(){var e=this,t=e.$createElement,r=e._self._c||t;return e.item?r("div",{staticClass:"table-actions"},[e.remove&&!e.hasCollection?r("control-button",{attrs:{title:"Отвязать",icon:"remove",color:"md-info"},on:{click:e.onRemove}}):e._e(),e._v(" "),r("router-button-link",{attrs:{title:"Сформировать проект",icon:"local_mall",color:"md-warning",to:{name:"cms.store.projects.create",params:{imageId:e.item.id}}}}),e._v(" "),e.hasCollection?r("router-button-link",{attrs:{title:"Коллекция",icon:"perm_media",color:"md-teal",to:{name:"cms.catalog.color-collections.images",params:{id:e.item.colorCollection.id}}}}):e._e(),e._v(" "),r("router-button-link",{attrs:{title:"Редактировать",icon:"edit",color:"md-success",to:{name:"cms.images.edit",params:{id:e.item.id}}}}),e._v(" "),r("control-button",{attrs:{title:"Удалить",icon:"delete",disabled:e.isCollectionMainImage,color:"md-danger"},on:{click:e.onDelete}})],1):e._e()}),[],!1,null,null,null);t.a=i.exports},195:function(e,t,r){var n=r(10),o=r(429);"string"==typeof(o=o.__esModule?o.default:o)&&(o=[[e.i,o,""]]);var i={insert:"head",singleton:!1};n(o,i);e.exports=o.locals||{}},4:function(e,t,r){"use strict";r.d(t,"a",(function(){return u})),r.d(t,"f",(function(){return l})),r.d(t,"c",(function(){return d})),r.d(t,"b",(function(){return m})),r.d(t,"g",(function(){return h})),r.d(t,"d",(function(){return g})),r.d(t,"e",(function(){return b}));var n=r(9),o=r.n(n),i=r(34),a=r.n(i);function s(e,t,r,n,o,i,a){try{var s=e[i](a),c=s.value}catch(e){return void r(e)}s.done?t(c):Promise.resolve(c).then(n,o)}function c(e){return function(){var t=this,r=arguments;return new Promise((function(n,o){var i=e.apply(t,r);function a(e){s(i,n,o,a,c,"next",e)}function c(e){s(i,n,o,a,c,"throw",e)}a(void 0)}))}}var u={methods:{create:function(e){var t=this;return c(o.a.mark((function r(){var n,i,s,c,u,l,d,m,f;return o.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return n=e.sendData,i=e.title,s=e.successText,c=e.redirectRoute,u=e.storeModule,l=void 0===u?null:u,d=e.action,m=void 0===d?"store":d,t.$store.commit("SET_LOADING",!0),f=l?"".concat(l,"/"):"",r.next=5,t.$store.dispatch("".concat(f).concat(m),n);case 5:return r.next=7,t.$router.push(c);case 7:return t.$store.commit("SET_LOADING",!1),r.abrupt("return",a.a.fire({title:s,text:"«".concat(i,"»"),timer:2e3,showConfirmButton:!1,icon:"success"}));case 9:case"end":return r.stop()}}),r)})))()}}},l={methods:{update:function(e){var t=this;return c(o.a.mark((function r(){var n,i,s,c,u,l,d,m;return o.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return n=e.sendData,i=e.title,s=e.successText,c=e.redirectRoute,u=void 0===c?null:c,l=e.storeModule,d=void 0===l?null:l,t.$store.commit("SET_LOADING",!0),m=d?"".concat(d,"/"):"",r.next=5,t.$store.dispatch("".concat(m,"update"),n);case 5:if(!u){r.next=12;break}if(!(window.history.length>1)){r.next=10;break}t.$router.go(-1),r.next=12;break;case 10:return r.next=12,t.$router.push(u);case 12:return t.$store.commit("SET_LOADING",!1),r.abrupt("return",a.a.fire({title:s,text:"«".concat(i,"»"),timer:2e3,showConfirmButton:!1,icon:"success"}));case 14:case"end":return r.stop()}}),r)})))()}}},d={methods:{delete:function(e){var t=this;return c(o.a.mark((function r(){var n,i,a,s,c,u,l,d,m,h,g,b,v,x,y,w;return o.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return n=e.payload,i=e.title,a=e.alertText,s=e.successText,c=e.storeModule,u=void 0===c?null:c,l=e.redirectRoute,d=void 0===l?null:l,m=e.tableMode,h=void 0!==m&&m,g=e.action,b=void 0===g?"delete":g,v=e.force,x=void 0!==v&&v,y=u?"".concat(u,"/"):"",w=x?"forceDelete":b,r.next=5,f(a);case 5:if(!r.sent.value){r.next=15;break}return t.$store.commit("SET_LOADING",!0),r.next=10,t.$store.dispatch("".concat(y).concat(w),{payload:n,tableMode:h});case 10:if(!d){r.next=13;break}return r.next=13,t.$router.push(d);case 13:return t.$store.commit("SET_LOADING",!1),r.abrupt("return",p(s,i));case 15:case"end":return r.stop()}}),r)})))()}}},m={methods:{deleteImageByIndex:function(e){var t=this;return c(o.a.mark((function r(){var n,i,a,s,c,u;return o.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return n=e.id,i=e.index,a=e.alertText,s=e.successText,c=e.storeModule,u=void 0===c?null:c,t.$store.commit("SET_LOADING",!0),r.next=4,f(a);case 4:if(!r.sent.value){r.next=11;break}return r.next=8,t.$store.dispatch("".concat(u,"/deleteImageByIndex"),{id:n,index:i});case 8:return t.$store.commit("SET_LOADING",!1),r.next=11,p(s,i);case 11:case"end":return r.stop()}}),r)})))()}}},f=function(e){return a.a.fire({title:"Вы уверены?",text:"Данное действие удалит ".concat(e," безвозвратно!"),icon:"warning",showCancelButton:!0,customClass:{confirmButton:"md-button md-success btn-fill",cancelButton:"md-button md-danger btn-fill"},confirmButtonText:"Удалить",cancelButtonText:"Отменить",buttonsStyling:!1})},p=function(e,t){return a.a.fire({title:e,text:"«".concat(t,"»"),timer:2e3,icon:"success",showConfirmButton:!1})},h={methods:{upload:function(e){var t=this;return c(o.a.mark((function r(){var n,i,s,c,u,l,d,m,f;return o.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(n=e.uploadFiles,i=e.type,s=void 0===i?null:i,c=e.id,u=void 0===c?null:c,l=e.storeModule,d=void 0===l?null:l,m=Array.from(n),f=d||"categories",!m.length){r.next=11;break}if(!u){r.next=9;break}return r.next=7,t.$store.dispatch("".concat(f,"/uploadImages"),{files:m,id:u,type:s});case 7:r.next=11;break;case 9:return r.next=11,t.$store.dispatch("images/store",m);case 11:return r.next=13,a.a.fire({title:"Изображения загружены!",text:"",timer:2e3,showConfirmButton:!1,icon:"success"});case 13:return r.abrupt("return",r.sent);case 14:case"end":return r.stop()}}),r)})))()}}},g={methods:{addImages:function(e){var t=this;return c(o.a.mark((function r(){var n,i;return o.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return n=e.id,i=e.data,r.next=3,t.$store.dispatch("categories/addSelectedImages",{id:n,data:i});case 3:return r.next=5,t.$router.push({name:"cms.catalog.categories.images",params:{id:n}});case 5:return r.abrupt("return",a.a.fire({title:"Изображения добавлены!",text:"",timer:2e3,showConfirmButton:!1,icon:"success"}));case 6:case"end":return r.stop()}}),r)})))()}}},b={methods:{addImages:function(e){var t=this;return c(o.a.mark((function r(){var n,i,s,c;return o.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return n=e.type,i=e.id,s=e.data,c=e.redirectRoute,r.next=3,t.$store.dispatch("subCategories/addSelectedImages",{type:n,id:i,data:s});case 3:return r.next=5,t.$router.push(c);case 5:return r.abrupt("return",a.a.fire({title:"Изображения добавлены!",text:"",timer:2e3,showConfirmButton:!1,icon:"success"}));case 6:case"end":return r.stop()}}),r)})))()}}}},428:function(e,t,r){"use strict";var n=r(195);r.n(n).a},429:function(e,t,r){(e.exports=r(16)(!1)).push([e.i,".md-between[data-v-01a81d08] {\n  display: -webkit-box;\n  display: -ms-flexbox;\n  display: flex;\n  -webkit-box-pack: justify;\n      -ms-flex-pack: justify;\n          justify-content: space-between;\n}\n.md-progress-bar__container[data-v-01a81d08] {\n  height: 4px;\n}",""])},697:function(e,t,r){"use strict";r.r(t);var n=r(2),o=r(5),i=r(4),a=r(96),s=r(112);function c(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function u(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?c(Object(r),!0).forEach((function(t){l(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):c(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function l(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var d={name:"ImageList",mixins:[o.b,i.c,i.g],components:{ImageListTable:a.a,ImageTableActions:s.a},props:{category_type:{type:String,default:"images"},id:{type:[Number,String],default:null}},data:function(){return{resourceUrl:"/catalog/".concat(this.category_type,"/").concat(this.id,"/images"),responseData:!1,storeModule:"images",redirectRoute:{name:"cms.catalog.subcategories.list",params:{category_type:this.category_type}}}},computed:u({},Object(n.d)({title:function(e){return e.subCategories.fields.title},fileProgress:function(e){return e.images.fileProgress}})),created:function(){var e=this;this.clearFieldsAction(),this.getItemAction({type:this.category_type,id:this.id}).then((function(){e.setPageTitle("Изображения «".concat(e.title,"»")),e.responseData=!0})).catch((function(){return e.$router.push(e.redirectRoute)}))},beforeDestroy:function(){this.clearFieldsAction()},methods:u(u({},Object(n.b)({clearFieldsAction:"subCategories/clearItemFields",getItemAction:"subCategories/getItem",togglePublishAction:"table/togglePublish",removeImageAction:"subCategories/removeImage"})),{},{fileInputChange:function(e){this.upload({uploadFiles:e.target.files,type:this.category_type,id:this.id,storeModule:"subCategories"})},onRemove:function(e){this.removeImageAction(e)},onDelete:function(e){this.delete({payload:e.id,title:e.id,alertText:"изображение «".concat(e.id,"»"),successText:"Изображение удалено!",storeModule:this.storeModule,tableMode:"table"})},togglePublish:function(e){this.togglePublishAction("/images/".concat(e,"/publish"))}})},m=(r(428),r(0)),f=Object(m.a)(d,(function(){var e=this,t=e.$createElement,r=e._self._c||t;return e.responseData?r("div",[r("div",{staticClass:"md-layout"},[r("div",{staticClass:"md-layout-item"},[r("md-card",{staticClass:"mt-0"},[r("md-card-content",{staticClass:"md-between"},[r("router-button-link",{attrs:{to:e.redirectRoute}}),e._v(" "),r("div",[r("router-button-link",{attrs:{icon:"add",color:"md-success",title:"Добавить изображения",to:{name:"cms.catalog.subcategories.images.excluded",params:{id:e.id}}}}),e._v(" "),r("upload-button",{on:{change:e.fileInputChange}})],1)],1)],1)],1)]),e._v(" "),r("div",{staticClass:"md-layout"},[r("div",{staticClass:"md-layout-item"},[r("div",{staticClass:"md-layout-item md-progress-bar__container"},[e.fileProgress?r("md-progress-bar",{staticClass:"md-info",attrs:{"md-mode":"indeterminate","md-value":e.fileProgress}}):e._e()],1),e._v(" "),r("md-card",[r("card-icon-header",{attrs:{title:"Каталог изображений",icon:"image"}}),e._v(" "),r("md-card-content",[r("image-list-table",{attrs:{resourceUrl:e.resourceUrl},on:{publish:e.togglePublish},scopedSlots:e._u([{key:"actions-column",fn:function(t){var n=t.item;return[n?r("md-table-cell",{attrs:{"md-label":"Действия"}},[r("image-table-actions",{attrs:{item:n,remove:!0},on:{remove:e.onRemove,delete:e.onDelete}})],1):e._e()]}}],null,!1,3891602051)})],1)],1)],1)])]):e._e()}),[],!1,null,"01a81d08",null);t.default=f.exports}}]);