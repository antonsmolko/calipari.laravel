(window.webpackJsonp=window.webpackJsonp||[]).push([[54],{234:function(e,t,r){(e.exports=r(16)(!1)).push([e.i,".img-raised[data-v-08aa066c]{-o-object-fit:cover;object-fit:cover}",""])},237:function(e,t,r){(e.exports=r(16)(!1)).push([e.i,".upload-button[data-v-12064ae6]{display:inline-block}.md-file-input[data-v-12064ae6]{display:none}",""])},28:function(e,t,r){"use strict";var n={name:"ThumbTableCell",components:{ResourceImage:r(51).a},props:{path:{type:String,default:null},width:{type:Number,default:100}}},a=r(5),i=r.n(a),o=r(234),s=r.n(o),c={insert:"head",singleton:!1},u=(i()(s.a,c),s.a.locals,r(0)),l=Object(u.a)(n,(function(){var e=this.$createElement;return(this._self._c||e)("resource-image",{staticClass:"md-table-thumb img-raised rounded",style:"width: "+this.width+"px; height: "+.6*this.width+"px",attrs:{name:this.path,width:2*this.width}})}),[],!1,null,"08aa066c",null);t.a=l.exports},312:function(e,t,r){(e.exports=r(16)(!1)).push([e.i,".md-between[data-v-03befbc2]{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-pack:justify;-ms-flex-pack:justify;justify-content:space-between}.md-progress-bar__container[data-v-03befbc2]{height:4px}",""])},4:function(e,t,r){"use strict";r.d(t,"a",(function(){return u})),r.d(t,"f",(function(){return l})),r.d(t,"c",(function(){return d})),r.d(t,"b",(function(){return p})),r.d(t,"g",(function(){return h})),r.d(t,"d",(function(){return b})),r.d(t,"e",(function(){return v}));var n=r(10),a=r.n(n),i=r(34),o=r.n(i);function s(e,t,r,n,a,i,o){try{var s=e[i](o),c=s.value}catch(e){return void r(e)}s.done?t(c):Promise.resolve(c).then(n,a)}function c(e){return function(){var t=this,r=arguments;return new Promise((function(n,a){var i=e.apply(t,r);function o(e){s(i,n,a,o,c,"next",e)}function c(e){s(i,n,a,o,c,"throw",e)}o(void 0)}))}}var u={methods:{create:function(e){var t=this;return c(a.a.mark((function r(){var n,i,s,c,u,l,d,p,m;return a.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return n=e.sendData,i=e.title,s=e.successText,c=e.redirectRoute,u=e.storeModule,l=void 0===u?null:u,d=e.action,p=void 0===d?"store":d,t.$store.commit("SET_LOADING",!0),m=l?"".concat(l,"/"):"",r.next=5,t.$store.dispatch("".concat(m).concat(p),n);case 5:return r.next=7,t.$router.push(c);case 7:return t.$store.commit("SET_LOADING",!1),r.abrupt("return",o.a.fire({title:s,text:"«".concat(i,"»"),timer:2e3,showConfirmButton:!1,icon:"success"}));case 9:case"end":return r.stop()}}),r)})))()}}},l={methods:{update:function(e){var t=this;return c(a.a.mark((function r(){var n,i,s,c,u,l,d,p;return a.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return n=e.sendData,i=e.title,s=e.successText,c=e.redirectRoute,u=void 0===c?null:c,l=e.storeModule,d=void 0===l?null:l,t.$store.commit("SET_LOADING",!0),p=d?"".concat(d,"/"):"",r.next=5,t.$store.dispatch("".concat(p,"update"),n);case 5:if(!u){r.next=12;break}if(!(window.history.length>1)){r.next=10;break}t.$router.go(-1),r.next=12;break;case 10:return r.next=12,t.$router.push(u);case 12:return t.$store.commit("SET_LOADING",!1),r.abrupt("return",o.a.fire({title:s,text:"«".concat(i,"»"),timer:2e3,showConfirmButton:!1,icon:"success"}));case 14:case"end":return r.stop()}}),r)})))()}}},d={methods:{delete:function(e){var t=this;return c(a.a.mark((function r(){var n,i,o,s,c,u,l,d,p,h,b,v,g,x,w,y;return a.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return n=e.payload,i=e.title,o=e.alertText,s=e.successText,c=e.storeModule,u=void 0===c?null:c,l=e.redirectRoute,d=void 0===l?null:l,p=e.tableMode,h=void 0!==p&&p,b=e.action,v=void 0===b?"delete":b,g=e.force,x=void 0!==g&&g,w=u?"".concat(u,"/"):"",y=x?"forceDelete":v,r.next=5,m(o);case 5:if(!r.sent.value){r.next=15;break}return t.$store.commit("SET_LOADING",!0),r.next=10,t.$store.dispatch("".concat(w).concat(y),{payload:n,tableMode:h});case 10:if(!d){r.next=13;break}return r.next=13,t.$router.push(d);case 13:return t.$store.commit("SET_LOADING",!1),r.abrupt("return",f(s,i));case 15:case"end":return r.stop()}}),r)})))()}}},p={methods:{deleteImageByIndex:function(e){var t=this;return c(a.a.mark((function r(){var n,i,o,s,c,u;return a.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return n=e.id,i=e.index,o=e.alertText,s=e.successText,c=e.storeModule,u=void 0===c?null:c,r.next=3,m(o);case 3:if(!r.sent.value){r.next=11;break}return t.$store.commit("SET_LOADING",!0),r.next=8,t.$store.dispatch("".concat(u,"/deleteImageByIndex"),{id:n,index:i});case 8:return t.$store.commit("SET_LOADING",!1),r.next=11,f(s,i);case 11:case"end":return r.stop()}}),r)})))()}}},m=function(e){return o.a.fire({title:"Вы уверены?",text:"Данное действие удалит ".concat(e," безвозвратно!"),icon:"warning",showCancelButton:!0,customClass:{confirmButton:"md-button md-success btn-fill",cancelButton:"md-button md-danger btn-fill"},confirmButtonText:"Удалить",cancelButtonText:"Отменить",buttonsStyling:!1})},f=function(e,t){return o.a.fire({title:e,text:"«".concat(t,"»"),timer:2e3,icon:"success",showConfirmButton:!1})},h={methods:{upload:function(e){var t=this;return c(a.a.mark((function r(){var n,i,s,c,u,l,d;return a.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(n=e.images,i=e.type,s=void 0===i?null:i,c=e.id,u=void 0===c?null:c,l=e.storeModule,d=(void 0===l?null:l)||"categories",!n.length){r.next=10;break}if(!u){r.next=8;break}return r.next=6,t.$store.dispatch("".concat(d,"/uploadImages"),{images:n,id:u,type:s});case 6:r.next=10;break;case 8:return r.next=10,t.$store.dispatch("images/store",n);case 10:return r.next=12,o.a.fire({title:"Изображения загружены!",text:"",timer:2e3,showConfirmButton:!1,icon:"success"});case 12:return r.abrupt("return",r.sent);case 13:case"end":return r.stop()}}),r)})))()}}},b={methods:{addImages:function(e){var t=this;return c(a.a.mark((function r(){var n,i;return a.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return n=e.id,i=e.data,r.next=3,t.$store.dispatch("categories/addSelectedImages",{id:n,data:i});case 3:return r.next=5,t.$router.push({name:"cms.catalog.categories.images",params:{id:n}});case 5:return r.abrupt("return",o.a.fire({title:"Изображения добавлены!",text:"",timer:2e3,showConfirmButton:!1,icon:"success"}));case 6:case"end":return r.stop()}}),r)})))()}}},v={methods:{addImages:function(e){var t=this;return c(a.a.mark((function r(){var n,i,s,c;return a.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return n=e.type,i=e.id,s=e.data,c=e.redirectRoute,r.next=3,t.$store.dispatch("subCategories/addSelectedImages",{type:n,id:i,data:s});case 3:return r.next=5,t.$router.push(c);case 5:return r.abrupt("return",o.a.fire({title:"Изображения добавлены!",text:"",timer:2e3,showConfirmButton:!1,icon:"success"}));case 6:case"end":return r.stop()}}),r)})))()}}}},584:function(e,t,r){"use strict";r.r(t);var n=r(2),a=r(6),i=r(4),o=r(87),s=r(28);function c(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function u(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?c(Object(r),!0).forEach((function(t){l(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):c(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function l(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var d={name:"ImageList",mixins:[a.b,i.b,i.g],components:{ImageUploader:o.a,ThumbTableCell:s.a},props:{id:{type:[Number,String],required:!0}},data:function(){return{mainImage:null,responseData:!1,storeModule:"workExamples",redirectRoute:{name:"cms.pages.portfolio",params:{activeTab:"Модули"}}}},computed:u({},Object(n.d)({title:function(e){return e.workExamples.fields.title},images:function(e){return e.workExamples.fields.images}})),created:function(){var e=this;Promise.all([this.getItemAction(this.id)]).then((function(){e.setPageTitle("Изображения работы «".concat(e.title,"»")),e.responseData=!0})).catch((function(){return e.$router.push(e.redirectRoute)}))},methods:u(u({},Object(n.b)({getItemAction:"workExamples/getItem"})),{},{fileInputChange:function(e){var t=e.images;this.upload({images:t,id:this.id,storeModule:this.storeModule})},onDelete:function(e){this.deleteImageByIndex({id:this.id,index:e.index,alertText:"изображение «".concat(e.index,"»"),successText:"Изображение удалено!",storeModule:this.storeModule})}})},p=r(5),m=r.n(p),f=r(312),h=r.n(f),b={insert:"head",singleton:!1},v=(m()(h.a,b),h.a.locals,r(0)),g=Object(v.a)(d,(function(){var e=this,t=e.$createElement,r=e._self._c||t;return e.responseData?r("div",[r("div",{staticClass:"md-layout"},[r("div",{staticClass:"md-layout-item"},[r("md-card",{staticClass:"mt-0"},[r("md-card-content",{staticClass:"md-between"},[r("router-button-link",{attrs:{to:e.redirectRoute}}),e._v(" "),r("image-uploader",{attrs:{multiple:!0},on:{change:e.fileInputChange}})],1)],1),e._v(" "),r("progress-bar-loading")],1)]),e._v(" "),r("div",{staticClass:"md-layout"},[r("div",{staticClass:"md-layout-item"},[r("md-card",[r("card-icon-header",{attrs:{title:"Список изображений",icon:"assignment"}}),e._v(" "),r("md-card-content",[e.images.length?[r("md-table",{staticClass:"paginated-table table-striped table-hover",attrs:{value:e.images},scopedSlots:e._u([{key:"md-table-row",fn:function(t){var n=t.item;return r("md-table-row",{},[e._t("first-column",[r("md-table-cell",{staticStyle:{width:"50px"},attrs:{"md-label":"#","md-sort-by":"id"}},[e._v("\n                                        "+e._s(n.index)+"\n                                    ")])],{item:n}),e._v(" "),r("md-table-cell",{attrs:{"md-label":"Превью"}},[r("thumb-table-cell",{attrs:{width:200,path:n.path}})],1),e._v(" "),r("md-table-cell",{attrs:{"md-label":"Действия"}},[r("div",{staticClass:"table-actions"},[r("control-button",{attrs:{title:"Удалить",icon:"delete",color:"md-danger"},on:{click:function(t){return e.onDelete(n)}}})],1)])],2)}}],null,!0)})]:[r("div",{staticClass:"alert alert-info"},[r("span",[r("h3",[e._v("В работе еще нет изображений! Загрузите их!")])])])]],2)],1)],1)])]):e._e()}),[],!1,null,"03befbc2",null);t.default=g.exports},87:function(e,t,r){"use strict";var n=r(10),a=r.n(n),i=r(2);function o(e){return function(e){if(Array.isArray(e))return s(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return s(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return s(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function s(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function c(e,t,r,n,a,i,o){try{var s=e[i](o),c=s.value}catch(e){return void r(e)}s.done?t(c):Promise.resolve(c).then(n,a)}function u(e){return function(){var t=this,r=arguments;return new Promise((function(n,a){var i=e.apply(t,r);function o(e){c(i,n,a,o,s,"next",e)}function s(e){c(i,n,a,o,s,"throw",e)}o(void 0)}))}}function l(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function d(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?l(Object(r),!0).forEach((function(t){p(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):l(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function p(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var m={name:"ImageUploader",mixins:[r(139).a],props:{multiple:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1},maxFileSize:{type:Number,default:15},width:{type:Number,default:1600},height:{type:Number,default:1200}},data:function(){return{previews:[],images:[],preview:null,image:null}},computed:d(d({},Object(i.d)({loading:function(e){return e.loading}})),{},{name:function(){return this.multiple?"images[]":"image"}}),methods:d(d({},Object(i.b)({setLoadingAction:"setLoading"})),{},{onChange:function(e){var t=this;return u(a.a.mark((function r(){var n;return a.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(t.setLoadingAction(!0),(n=e.target.files||e.dataTransfer.files).length){r.next=4;break}return r.abrupt("return",null);case 4:if(!t.multiple){r.next=9;break}return r.next=7,t.handleMultipleChange(n);case 7:r.next=11;break;case 9:return r.next=11,t.handleSingleChange(n[0]);case 11:case"end":return r.stop()}}),r)})))()},handleMultipleChange:function(e){var t=this;return u(a.a.mark((function r(){var n,i;return a.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,t.processMultipleImages(e);case 2:n=o(t.previews),i=o(t.images),t.$emit("change",{previews:n,images:i}),t.previews=[],t.images=[];case 7:case"end":return r.stop()}}),r)})))()},handleSingleChange:function(e){var t=this;return u(a.a.mark((function r(){var n,i;return a.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,t.processImage(e);case 2:n=Object.assign({},t.preview),i=Object.assign({},t.image),t.$emit("change",{preview:n,image:i}),t.preview=null,t.image=null;case 7:case"end":return r.stop()}}),r)})))()},processMultipleImages:function(e){var t=this;return u(a.a.mark((function r(){var n,i,o,s;return a.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:n=0,i=Object.values(e);case 1:if(!(n<i.length)){r.next=11;break}return o=i[n],r.next=5,t.processImage(o);case 5:s=r.sent,t.images.push(s.image),t.previews.push(s.preview);case 8:n++,r.next=1;break;case 11:case"end":return r.stop()}}),r)})))()},processSingleImage:function(e){var t=this;return u(a.a.mark((function r(){var n,i,o;return a.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,t.processImage(e,t.width,t.height);case 2:n=r.sent,i=n.preview,o=n.image,t.preview=i,t.image=o;case 7:case"end":return r.stop()}}),r)})))()}})},f=r(5),h=r.n(f),b=r(237),v=r.n(b),g={insert:"head",singleton:!1},x=(h()(v.a,g),v.a.locals,r(0)),w=Object(x.a)(m,(function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"upload-button"},[r("input",{ref:"fileInput",staticClass:"md-file-input",attrs:{type:"file",multiple:e.multiple,name:e.name},on:{change:e.onChange}}),e._v(" "),r("md-button",{staticClass:"md-success md-just-icon",attrs:{disabled:e.disabled||e.loading},on:{click:function(t){return e.$refs.fileInput.click()}}},[r("md-icon",[e._v("get_app")]),e._v(" "),r("md-tooltip",{attrs:{"md-direction":"right"}},[e._v("Загрузить изображения")])],1)],1)}),[],!1,null,"12064ae6",null);t.a=w.exports}}]);